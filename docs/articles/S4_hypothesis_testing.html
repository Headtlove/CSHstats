<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="CSHstats">
<title>S4_inference: Definitions and exercises • CSHstats</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><link href="../deps/_Roboto-0.4.1/font.css" rel="stylesheet">
<link href="../deps/_Courier%20Prime-0.4.1/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="S4_inference: Definitions and exercises">
<meta property="og:description" content="CSHstats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CSHstats</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.14</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/S1_probability.html">S1_probability: Definitions and exercises</a>
    <a class="dropdown-item" href="../articles/S2_EDA.html">S2_EDA: Exploratory data analysis and visualization</a>
    <a class="dropdown-item" href="../articles/S3_distclust.html">S3: Distances, clustering</a>
    <a class="dropdown-item" href="../articles/S4_hypothesis_testing.html">S4_inference: Definitions and exercises</a>
    <a class="dropdown-item" href="../articles/S5_linear_models.html">S5_inference: Linear models and GLMs</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/vjcitn/CSHstats/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>S4_inference: Definitions and exercises</h1>
                        <h4 data-toc-skip class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">July 03, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/CSHstats/blob/HEAD/vignettes/S4_hypothesis_testing.Rmd" class="external-link"><code>vignettes/S4_hypothesis_testing.Rmd</code></a></small>
      <div class="d-none name"><code>S4_hypothesis_testing.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="inference">Inference<a class="anchor" aria-label="anchor" href="#inference"></a>
</h2>
<div class="section level3">
<h3 id="the-fairness-hypothesis">The fairness hypothesis<a class="anchor" aria-label="anchor" href="#the-fairness-hypothesis"></a>
</h3>
<p>Let <span class="math inline">\(C_1\)</span> denote the suit of the top card revealed after a fair shuffle.
We can state a hypothesis about the fairness of the deck
under repeated draws of top card after shuffling as</p>
<p><span class="math display">\[
H_0: Pr(C_1 = \heartsuit) = Pr(C_1 = \diamondsuit) = Pr(C_1 = \clubsuit) = Pr(C_1 = \spadesuit) = 1/4
\]</span></p>
<p>In a frequentist framework for statistical inference, we
define procedures for testing (null) hypotheses with specified
error probabilities.</p>
<ul>
<li><p>A <strong>Type I error</strong> occurs when the
null hypothesis is true but the test results in the assertion that it is
false. Traditionally we try to keep the probability of Type I errors
below 5%.</p></li>
<li><p>A <strong>Type II error</strong> occurs when the
null hypothesis is false but the test does not result in an
assertion that it is false. Traditionally we try to keep the
probability of Type II errors below 20%.</p></li>
</ul>
<div class="section level4">
<h4 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h4>
<p><strong>1: Propose a procedure for testing <span class="math inline">\(H_0: Pr(C_1 = \heartsuit) = 1/4\)</span>. Assume you have
the results of top card draws from N shuffles. What would such a procedure look like?</strong></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="op">{</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="op">{</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/CSHstats" class="external-link">CSHstats</a></span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>
<span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="../reference/build_deck.html">build_deck</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">shuffle_deck</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">d</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">heart_sign</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="st">"\U2661"</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4141</span><span class="op">)</span>
<span class="va">top_draw</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu">shuffle_deck</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="va">N</span> <span class="op">=</span> <span class="fl">100</span>
<span class="va">mydat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="va">phat</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="fu">phat</span><span class="op">(</span><span class="va">mydat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.35</span></code></pre>
<p>With 100 shuffles we have an estimate of the probability of a
heart. Is our experimental result consistent with <span class="math inline">\(H_0\)</span>?</p>
<p>With a larger sample size:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">=</span> <span class="fl">1000</span>
<span class="va">mydat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">mydat</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mydat</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.243</span></code></pre>
<p>Let’s use the procedure <code>|phat(dat)-.25|&gt;.01</code> as our criterion for
rejecting $H_0 : <span class="math inline">\(Pr(C_1 = \heartsuit)\)</span>. What is the Type I error rate
for a fair deck for the experiment based on 100 shuffles?</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N</span> <span class="op">=</span> <span class="fl">100</span>
<span class="va">NSIM</span> <span class="op">=</span> <span class="fl">1000</span>
<span class="va">tsts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">NSIM</span>,
   <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">.25</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">tsts</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.911</span></code></pre>
<p>Parameterize the “delta”, which was 0.01 in the previous run. Let’s
get the rejection rate estimates for two sample sizes:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">prej</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">delta</span><span class="op">=</span><span class="fl">.01</span>, <span class="va">nullval</span><span class="op">=</span><span class="fl">.25</span>, <span class="va">NSIM</span>, <span class="va">N</span><span class="op">)</span> <span class="op">{</span>
 <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">NSIM</span>,
   <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="va">nullval</span><span class="op">)</span><span class="op">&gt;</span><span class="va">delta</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu">prej</span><span class="op">(</span>delta<span class="op">=</span><span class="fl">.02</span>, NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">100</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.655</span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">prej</span><span class="op">(</span>delta<span class="op">=</span><span class="fl">.02</span>, NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">500</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.323</span></code></pre>
<p>Our home-cooked test has a Type I error rate that is much too high
for standard practice, and depends on the sample size.</p>
<p>Let’s instead use the built in procedure for testing hypotheses
with binomial
outcomes.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">brej</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">deck</span>, <span class="va">nullval</span><span class="op">=</span><span class="fl">.25</span>, <span class="va">alpha</span><span class="op">=</span><span class="fl">0.05</span>, <span class="va">NSIM</span>, <span class="va">N</span><span class="op">)</span> <span class="op">{</span>
 <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">NSIM</span>, <span class="op">{</span>
   <span class="va">dat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">deck</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
   <span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="va">N</span>, <span class="va">nullval</span><span class="op">)</span><span class="op">$</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="va">alpha</span>
   <span class="op">}</span><span class="op">)</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">d</span>,NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.054</span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">d</span>,NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">500</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.06</span></code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">d</span>,NSIM<span class="op">=</span><span class="fl">1000</span>, N<span class="op">=</span><span class="fl">100</span>, alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.006</span></code></pre>
<p>We have an indication here that the procedure stabilizes the Type I error
rate for different designs (sample sizes) and can accommodate different
significance levels.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="power-curve">Power curve<a class="anchor" aria-label="anchor" href="#power-curve"></a>
</h2>
<p>Now we want to understand how good a given experimental design
is at identifying departures from the null. Make a biased deck.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bd</span> <span class="op">=</span> <span class="va">d</span>
<span class="va">bd</span><span class="op">[</span><span class="fl">18</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    </span>
<span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span>
<span class="co">##   ♡  1 1 1 1 2 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♢  1 1 1 1 1 0 1 1 1 1 1 1 1</span>
<span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre>
<p>What kind of sample size do we need to get good power to detect this
exception?</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ssizes</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">50</span>, <span class="fl">100</span>, <span class="fl">300</span>,<span class="fl">750</span><span class="op">)</span>
<span class="va">rejps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">bd</span>, NSIM<span class="op">=</span><span class="fl">100</span>, N<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="va">rejps</span>, main<span class="op">=</span><span class="st">"detect one extra heart"</span><span class="op">)</span></code></pre></div>
<p><img src="S4_hypothesis_testing_files/figure-html/docur-1.png" width="672"></p>
<p>More bias:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bd</span><span class="op">[</span><span class="fl">19</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    </span>
<span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span>
<span class="co">##   ♡  1 1 1 1 2 2 1 1 1 1 1 1 1</span>
<span class="co">##   ♢  1 1 1 1 1 0 0 1 1 1 1 1 1</span>
<span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rejps</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">bd</span>, NSIM<span class="op">=</span><span class="fl">100</span>, N<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="va">rejps</span>, main<span class="op">=</span><span class="st">"detect two extra hearts"</span><span class="op">)</span></code></pre></div>
<p><img src="S4_hypothesis_testing_files/figure-html/domor-1.png" width="672"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rejps_n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu">brej</span><span class="op">(</span><span class="va">d</span>, NSIM<span class="op">=</span><span class="fl">100</span>, N<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ssizes</span>, <span class="va">rejps_n</span>, main<span class="op">=</span><span class="st">"preserve Type I error rate"</span><span class="op">)</span></code></pre></div>
<p><img src="S4_hypothesis_testing_files/figure-html/domor-2.png" width="672"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
