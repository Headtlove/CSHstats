<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>S1_probability: Definitions and exercises • CSHstats</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="S1_probability: Definitions and exercises">
<meta property="og:description" content="CSHstats">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CSHstats</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/S1_probability.html">S1_probability: Definitions and exercises</a>
    </li>
    <li>
      <a href="../articles/S2_EDA.html">S2_EDA: Exploratory data analysis and visualization</a>
    </li>
    <li>
      <a href="../articles/S3_hypothesis_testing.html">S3_inference: Definitions and exercises</a>
    </li>
    <li>
      <a href="../articles/S4_linear_models.html">S4_inference: Linear models and GLMs</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vjcitn/CSHstats/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>S1_probability: Definitions and exercises</h1>
                        <h4 data-toc-skip class="author">Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">May 19, 2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/CSHstats/blob/HEAD/vignettes/S1_probability.Rmd"><code>vignettes/S1_probability.Rmd</code></a></small>
      <div class="hidden name"><code>S1_probability.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Our concept of probability is that of “long run relative frequency”.</p>
<p>We’ll work with several models of random events to make this more concrete.</p>
</div>
<div class="section level2">
<h2 id="the-probability-of-a-0-1-binary-or-dichotomous-event">The probability of a 0-1 (binary or dichotomous) event<a class="anchor" aria-label="anchor" href="#the-probability-of-a-0-1-binary-or-dichotomous-event"></a>
</h2>
<div class="section level3">
<h3 id="simulating-shuffled-playing-cards">Simulating shuffled playing cards<a class="anchor" aria-label="anchor" href="#simulating-shuffled-playing-cards"></a>
</h3>
<div class="section level4">
<h4 id="random-permutations-with-sample">Random permutations with <code>sample()</code><a class="anchor" aria-label="anchor" href="#random-permutations-with-sample"></a>
</h4>
<p>We’ll take for granted that <code>sample(x, size=length(x), replace=FALSE)</code> in R
achieves a goal of “shuffling” elements of <code>x</code>. Thus we assume that,
if <code>x</code> is a vector in R, and</p>
<pre><code><span class="va">s1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">x</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">s2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">x</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre>
<p>then no aspect of the ordering of elements in
<code>s1</code> can be used to predict anything about the ordering of elements of <code>s2</code>.</p>
<p>In other words, <code>sample(x, size, replace=FALSE)</code> is taken as a primitive operation
that permutes the elements of <code>x</code> in a “random” way.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5432</span><span class="op">)</span> <span class="co"># initialize, for reproducibility, the random number generator</span>
<span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># permute (1,2,3,4,5)</span></code></pre></div>
<pre><code><span class="co">## [1] 4 2 1 3 5</span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># a new, unpredictable, permutation</span></code></pre></div>
<pre><code><span class="co">## [1] 3 4 1 2 5</span></code></pre>
<div class="section level5">
<h5 id="exercises">Exercises<a class="anchor" aria-label="anchor" href="#exercises"></a>
</h5>
<p><strong>1: Why is the second permutation produced above termed “unpredictable”?</strong></p>
<p><strong>2: Predict the outcome of <code>sample(1:5, replace=FALSE)</code>, run just
after the one shown above.</strong></p>
</div>
</div>
<div class="section level4">
<h4 id="card-deck-definitions-and-operations">Card deck definitions and operations<a class="anchor" aria-label="anchor" href="#card-deck-definitions-and-operations"></a>
</h4>
<p>Our card deck is a vector with 52 elements. Unicode characters encode the “suits”.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/CSHstats">CSHstats</a></span><span class="op">)</span>
<span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="../reference/build_deck.html">build_deck</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">d</span></code></pre></div>
<pre><code><span class="co">##  [1] "2 ♡"  "3 ♡"  "4 ♡"  "5 ♡"  "6 ♡"  "7 ♡"  "8 ♡"  "9 ♡"  "10 ♡" "J ♡" </span>
<span class="co">## [11] "Q ♡"  "K ♡"  "A ♡"  "2 ♢"  "3 ♢"  "4 ♢"  "5 ♢"  "6 ♢"  "7 ♢"  "8 ♢" </span>
<span class="co">## [21] "9 ♢"  "10 ♢" "J ♢"  "Q ♢"  "K ♢"  "A ♢"  "2 ♣"  "3 ♣"  "4 ♣"  "5 ♣" </span>
<span class="co">## [31] "6 ♣"  "7 ♣"  "8 ♣"  "9 ♣"  "10 ♣" "J ♣"  "Q ♣"  "K ♣"  "A ♣"  "2 ♤" </span>
<span class="co">## [41] "3 ♤"  "4 ♤"  "5 ♤"  "6 ♤"  "7 ♤"  "8 ♤"  "9 ♤"  "10 ♤" "J ♤"  "Q ♤" </span>
<span class="co">## [51] "K ♤"  "A ♤"</span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "♡" "♢" "♣" "♤"</span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##  [1] "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "J"  "Q"  "K"  "A"</span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    </span>
<span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span>
<span class="co">##   ♡  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♢  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre>
<p>A fair deck has one card for each combination of “face” and “suit”.</p>
<div class="section level5">
<h5 id="exercises-1">Exercises<a class="anchor" aria-label="anchor" href="#exercises-1"></a>
</h5>
<p><strong>3: Write the code that produces a new deck that is
fair except that it has two copies
of the ten of hearts. Verify that your new deck has this property.</strong></p>
</div>
</div>
<div class="section level4">
<h4 id="shuffling-the-deck">Shuffling the deck<a class="anchor" aria-label="anchor" href="#shuffling-the-deck"></a>
</h4>
<p>A reproducible shuffling event can be programmed as follows:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>  <span class="co"># any numeric seed will do but you need to record it</span>
<span class="va">shuffle_deck</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">d</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>         <span class="co"># top 6 cards</span></code></pre></div>
<pre><code><span class="co">## [1] "2 ♡" "3 ♡" "4 ♡" "5 ♡" "6 ♡" "7 ♡"</span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu">shuffle_deck</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "3 ♣"  "4 ♢"  "10 ♢" "Q ♣"  "6 ♤"  "9 ♤"</span></code></pre>
</div>
<div class="section level4">
<h4 id="the-top-card-after-a-shuffle">The top card after a shuffle<a class="anchor" aria-label="anchor" href="#the-top-card-after-a-shuffle"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">top_draw</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu">shuffle_deck</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
<span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "J ♤"</span></code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "10 ♣"</span></code></pre>
<div class="section level5">
<h5 id="exercises-2">Exercises<a class="anchor" aria-label="anchor" href="#exercises-2"></a>
</h5>
<p><strong>4: What is the top card in the next shuffle?</strong></p>
<p><strong>5: Write code to get the third card.</strong></p>
<p><strong>6: What is the probability that the top draw of a shuffled fair deck is a heart?</strong></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="estimating-the-probability-of-an-event">Estimating the probability of an event<a class="anchor" aria-label="anchor" href="#estimating-the-probability-of-an-event"></a>
</h3>
<div class="section level4">
<h4 id="a-simulation-process-repeated-shuffles-and-draws">A simulation process: repeated shuffles and draws<a class="anchor" aria-label="anchor" href="#a-simulation-process-repeated-shuffles-and-draws"></a>
</h4>
<p>Here’s a simple way of estimating the probability, construed as long run frequency.</p>
<p>We’ll simulate 100 shuffles and save the results of testing the suit of the top card.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">heart_sign</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="st">"\U2661"</span>  <span class="co"># unicode U2661, prepend backslash</span>
<span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] "♡"</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">100</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span>
 <span class="va">res</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="co"># TRUE if top card is a heart</span>
<span class="op">}</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] FALSE FALSE FALSE FALSE FALSE FALSE</span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">### relative frequency of the event "suit of top card is 'heart'"</span>
<span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span>  </code></pre></div>
<pre><code><span class="co">## [1] 0.26</span></code></pre>
<p>A more concise approach with R is:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span> <span class="fl">100</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## [1] 0.29</span></code></pre>
<div class="section level5">
<h5 id="exercises-3">Exercises<a class="anchor" aria-label="anchor" href="#exercises-3"></a>
</h5>
<p><strong>7: How do we interpret the difference between the two probability estimates given here?</strong></p>
</div>
</div>
<div class="section level4">
<h4 id="replicating-the-estimation-process">Replicating the estimation process<a class="anchor" aria-label="anchor" href="#replicating-the-estimation-process"></a>
</h4>
<p>Let’s intensify our investigation with an aim
of understanding the uncertainty of estimation.</p>
<p>We’ll define a variable that gives the size of our “experiment”: we are shuffling
100 times and we’ll refer to this as the sample size, <code>SSIZE</code></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SSIZE</span> <span class="op">=</span> <span class="fl">100</span></code></pre></div>
<p>We will study the estimation procedure by replicating the experiment <code>N_REPLICATION</code> times.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">N_REPLICATION</span> <span class="op">=</span> <span class="fl">500</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10101</span><span class="op">)</span> <span class="co"># initialize, for reproducibility, the random number generator</span>
<span class="va">doubsim</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N_REPLICATION</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span> <span class="va">SSIZE</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">doubsim</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkhist1-1.png" width="672"></p>
<div class="section level5">
<h5 id="exercises-4">Exercises<a class="anchor" aria-label="anchor" href="#exercises-4"></a>
</h5>
<p><strong>8: How can we make the estimate of the probability of the event “suit of top card is ‘heart’” more precise?</strong></p>
<p>Answer: increase <code>SSIZE</code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">SSIZE</span> <span class="op">=</span> <span class="fl">500</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101012</span><span class="op">)</span>
<span class="va">doubsim2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N_REPLICATION</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span> <span class="va">SSIZE</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">doubsim2</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/lkhj-1.png" width="672"></p>
<p>With an increased “sample size”,
we have reduced variation in our experiment-to-experiment estimates of the probability
of heart as suit of top card.</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="formal-probability-models">Formal probability models<a class="anchor" aria-label="anchor" href="#formal-probability-models"></a>
</h3>
<p>Intuitively, the probability of drawing a heart from a well-shuffled
fair deck is 1/4. If we repeat the shuffling and drawing one hundred times,
we expect <strong>around</strong> 25 draws to reveal a heart.</p>
<p>Formal probability models enable us to reason systematically about
what we mean by <strong>around</strong> in our description of our expectation.
With these models we can also create accurate predictions of likely outcomes in
more complex events.</p>
<div class="section level4">
<h4 id="using-the-binomial-probability-model">Using the binomial probability model<a class="anchor" aria-label="anchor" href="#using-the-binomial-probability-model"></a>
</h4>
<p>A series of independent dichotomous events (true or false, zero or one, heart or non-heart)
can be modeled using a <strong>probability mass function</strong> for the binomial distribution. There are two parameters,
<span class="math inline">\(p\)</span> and <span class="math inline">\(n\)</span>, where <span class="math inline">\(p\)</span> is the (unobservable) probability of the event (say “suit of top card is ‘heart’”)
and <span class="math inline">\(n\)</span> is the number of <strong>independent</strong> trials in which the random dichotomy is observed. In <span class="math inline">\(n\)</span> “trials”,
if the event has probability <span class="math inline">\(p\)</span>, the probability of seeing the event <span class="math inline">\(x\)</span> times is
<span class="math display">\[
Pr(X = x; n, p) = {\binom{n}{x}} p^x(1-p)^{n-x}
\]</span>
where have written <span class="math inline">\(X\)</span> to denote the random quantity and <span class="math inline">\(x\)</span> to denote its realization.</p>
<p>So for a single draw, with <span class="math inline">\(X\)</span> the count of hearts seen in the draw, we have
<span class="math display">\[
Pr(X=0; 1, 1/4) = 1-1/4 = 3/4
\]</span>
<span class="math display">\[
Pr(X=1; 1, 1/4) = 1/4
\]</span></p>
<div class="section level5">
<h5 id="exercises-5">Exercises<a class="anchor" aria-label="anchor" href="#exercises-5"></a>
</h5>
<p><strong>9: Modify the production of <code>doubsim2</code> so that the <span class="math inline">\(x\)</span>-axis for the
histogram has units “number of times the top card is a heart”.</strong></p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">43212</span><span class="op">)</span>
<span class="va">doubsim3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">N_REPLICATION</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span> <span class="va">SSIZE</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fu">heart_sign</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span>
    <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">doubsim3</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.15</span><span class="op">*</span><span class="fl">500</span>,<span class="fl">.35</span><span class="op">*</span><span class="fl">500</span><span class="op">)</span>, xlab<span class="op">=</span><span class="st">"count of draws with heart as suit of top card"</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/dodou3h-1.png" width="672"></p>
</div>
</div>
<div class="section level4">
<h4 id="visualizing-the-model-and-the-data">Visualizing the model and the data<a class="anchor" aria-label="anchor" href="#visualizing-the-model-and-the-data"></a>
</h4>
<p>The formula given above tells us how frequently we will observe a given count. The
R function <code>dbinom</code> can compute the probability, which we multiply by the number
of realizations to get the height of the histogram.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">doubsim3</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.15</span><span class="op">*</span><span class="fl">500</span>,<span class="fl">.35</span><span class="op">*</span><span class="fl">500</span><span class="op">)</span>, 
   xlab<span class="op">=</span><span class="st">"count of draws with heart as suit of top card"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">115</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">80</span><span class="op">:</span><span class="fl">160</span>, <span class="fl">2500</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">dbinom</a></span><span class="op">(</span><span class="fl">80</span><span class="op">:</span><span class="fl">160</span>, <span class="fl">500</span>, <span class="fl">13</span><span class="op">/</span><span class="fl">52</span><span class="op">)</span>, pch<span class="op">=</span><span class="fl">19</span>, cex<span class="op">=</span><span class="fl">.5</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="fl">78</span>, <span class="fl">110</span>, pch<span class="op">=</span><span class="fl">19</span>, legend<span class="op">=</span><span class="st">"scaled dbinom(x, 500, .25)"</span>, bty<span class="op">=</span><span class="st">"n"</span>, cex<span class="op">=</span><span class="fl">.85</span><span class="op">)</span></code></pre></div>
<p><img src="S1_probability_files/figure-html/sketch-1.png" width="672"></p>
<p>Notice that the histogram, by virtue of its binning of the counts, does
not seem to reflect the shape of the theoretical frequency function given by the dots.
This can be remedied by increasing the number of replicates used.</p>
<p>There is considerable research regarding the design of histogram displays.
See <code><a href="https://rdrr.io/r/grDevices/nclass.html" class="external-link">?nclass.Sturges</a></code> for references. One unpleasant feature of the
display for doubsim2 is that it seems to imply an asymmetric distribution.
Another is the way it “cuts off” at the extremes.</p>
<div class="section level5">
<h5 id="exercises-6">Exercises<a class="anchor" aria-label="anchor" href="#exercises-6"></a>
</h5>
<p><strong>10: Write a couple of sentences carefully distinguishing the
displays of doubsim2 and doubsim3 above. Explain the choice of
the heuristic name “doubsim”.</strong></p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="a-biased-deck">A biased deck<a class="anchor" aria-label="anchor" href="#a-biased-deck"></a>
</h3>
<p>Recall the layout of the fair deck:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">d</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    </span>
<span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span>
<span class="co">##   ♡  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♢  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre>
<p>We will make a copy of one card and remove one:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bd</span> <span class="op">=</span> <span class="va">d</span>
<span class="va">bd</span><span class="op">[</span><span class="fl">18</span><span class="op">]</span> <span class="op">=</span> <span class="va">bd</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span>, <span class="fu"><a href="../reference/faces.html">faces</a></span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##    </span>
<span class="co">##     10 2 3 4 5 6 7 8 9 A J K Q</span>
<span class="co">##   ♡  1 1 1 2 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♢  1 1 1 1 1 0 1 1 1 1 1 1 1</span>
<span class="co">##   ♣  1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="co">##   ♤  1 1 1 1 1 1 1 1 1 1 1 1 1</span></code></pre>
<div class="section level4">
<h4 id="exercises-7">Exercises<a class="anchor" aria-label="anchor" href="#exercises-7"></a>
</h4>
<p><strong>11: What is the probability that the top card drawn after
a fair shuffle of <code>bd</code> is a heart?</strong></p>
<p><strong>12: What is the probability that the top card drawn after
a fair shuffle of <code>bd</code> is a club?</strong></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="probability-models-for-categorical-outcomes">Probability models for categorical outcomes<a class="anchor" aria-label="anchor" href="#probability-models-for-categorical-outcomes"></a>
</h2>
<p>Thus far we have focused on the dichotomy: top draw is heart or not.
We can consider all the possible suits as a 4-valued response.</p>
<div class="section level3">
<h3 id="a-contingency-table">A contingency table<a class="anchor" aria-label="anchor" href="#a-contingency-table"></a>
</h3>
<p>Let’s simulate the process of drawing the top card after
shuffling, and tabulate the suits observed.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4321</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span> <span class="va">tops</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fu"><a href="../reference/suits.html">suits</a></span><span class="op">(</span><span class="fu">top_draw</span><span class="op">(</span><span class="va">bd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##   ♡   ♢   ♣   ♤ </span>
<span class="co">## 148 106 126 120</span></code></pre>
<div class="section level4">
<h4 id="exercises-8">Exercises<a class="anchor" aria-label="anchor" href="#exercises-8"></a>
</h4>
<p><strong>13: What would you expect for the counts for suits in the table above
if the deck were fair?</strong></p>
</div>
</div>
<div class="section level3">
<h3 id="multinomial-model-and-simulation">Multinomial model and simulation<a class="anchor" aria-label="anchor" href="#multinomial-model-and-simulation"></a>
</h3>
<p>We adopted the binomial model for the number of top draws
with suit “heart” in a fixed number of shuffles:</p>
<p><span class="math display">\[
Pr(X = x; n, p) = {\binom{n}{x}} p^x(1-p)^{n-x}
\]</span></p>
<p>With the fair deck, we have <span class="math inline">\(p= 1/4\)</span>. A generalization
to a vector of responses is the multinomial model. We
can use this for the (ordered) vector of counts of
top draws yielding different suits. For this problem
we have parameters <span class="math inline">\(N\)</span> (number of trials), <span class="math inline">\(k\)</span> (number
of categories), and <span class="math inline">\(p_1, \ldots, p_k\)</span>, the category-specific
probabilities. The realizations are denoted <span class="math inline">\(x_1, \ldots, x_k\)</span>
and we have <span class="math inline">\(\sum_i x_i = N\)</span>.</p>
<p>Now the probability model is defined in terms of random
vectors and vectors of probabilities:</p>
<p><span class="math display">\[
Pr(X_1 = x_1, \ldots, X_k = x_k) = \frac{n!}{x_1! \cdots x_k!} p_1^{x_1} \cdots p_k^{x_k}
\]</span></p>
<p>This provides a more elegant way of producing frequency distributions
of the suit of the top draw.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NREP</span> <span class="op">=</span> <span class="fl">10000</span>
<span class="va">SSIZE</span> <span class="op">=</span> <span class="fl">500</span>
<span class="va">mnmat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="va">NREP</span>, <span class="va">SSIZE</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mnmat</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"\U2661"</span>, <span class="st">"\U2662"</span>, <span class="st">"\U2663"</span>, <span class="st">"\U2664"</span><span class="op">)</span>
<span class="va">mnmat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>  <span class="co"># one draw</span></code></pre></div>
<pre><code><span class="co">##   ♡   ♢   ♣   ♤ </span>
<span class="co">## 131 125 110 134</span></code></pre>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">mnmat</span>,<span class="fl">1</span>,<span class="va">mean</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##        ♡        ♢        ♣        ♤ </span>
<span class="co">## 124.9621 124.9080 125.0362 125.0937</span></code></pre>
<p>Notice that we did not really use the deck <code>d</code> in producing this matrix
of counts. Previously we applied <code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample()</a></code> to the 52-vector of
cards. Now we use the model to develop the data
of interest.</p>
<div class="section level4">
<h4 id="exercise">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h4>
<p><strong>14: Modify the call to <code>rmultinom</code> to obtain distributions of
top card suits for the biased deck <code>bd</code>.<br>
Hint: Change the part of the call involving <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code>.</strong></p>
</div>
</div>
<div class="section level3">
<h3 id="additional-discrete-distributions-poisson-zipf-nb">Additional discrete distributions (Poisson, Zipf, NB, …)<a class="anchor" aria-label="anchor" href="#additional-discrete-distributions-poisson-zipf-nb"></a>
</h3>
</div>
</div>
<div class="section level2">
<h2 id="models-for-continuous-outcomes">Models for continuous outcomes<a class="anchor" aria-label="anchor" href="#models-for-continuous-outcomes"></a>
</h2>
<div class="section level3">
<h3 id="univariate-response">Univariate response<a class="anchor" aria-label="anchor" href="#univariate-response"></a>
</h3>
<div class="section level4">
<h4 id="histogram-probability-density-function">Histogram, probability density function<a class="anchor" aria-label="anchor" href="#histogram-probability-density-function"></a>
</h4>
</div>
<div class="section level4">
<h4 id="moments-parameters">Moments, parameters<a class="anchor" aria-label="anchor" href="#moments-parameters"></a>
</h4>
</div>
<div class="section level4">
<h4 id="gaussian-model">Gaussian model<a class="anchor" aria-label="anchor" href="#gaussian-model"></a>
</h4>
</div>
<div class="section level4">
<h4 id="exponential-and-gamma-models-for-survival-data">Exponential and Gamma models for survival data<a class="anchor" aria-label="anchor" href="#exponential-and-gamma-models-for-survival-data"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="multivariate-response">Multivariate response<a class="anchor" aria-label="anchor" href="#multivariate-response"></a>
</h3>
<div class="section level4">
<h4 id="probabilistic-independence-and-dependence">Probabilistic independence and dependence<a class="anchor" aria-label="anchor" href="#probabilistic-independence-and-dependence"></a>
</h4>
</div>
<div class="section level4">
<h4 id="measures-of-correlation">Measures of correlation<a class="anchor" aria-label="anchor" href="#measures-of-correlation"></a>
</h4>
</div>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-concepts-of-probability-following-mcelreath-statistical-rethinking">Bayesian concepts of probability (following McElreath, Statistical Rethinking?)<a class="anchor" aria-label="anchor" href="#bayesian-concepts-of-probability-following-mcelreath-statistical-rethinking"></a>
</h2>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vince Carey.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
